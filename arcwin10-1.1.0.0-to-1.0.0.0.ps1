function CommandExists {
    param(
        [string]$command
    )
    $null -ne (Get-Command $command -ErrorAction SilentlyContinue)
}

function Xdelta3Installed {
    Get-Command xdelta3 -ErrorAction SilentlyContinue
}

function Get-FileMD5 {
    param (
        [string]$filePath
    )
    $md5 = [System.Security.Cryptography.MD5]::Create()
    $fileStream = [System.IO.File]::OpenRead($filePath)
    $hashBytes = $md5.ComputeHash($fileStream)
    $fileStream.Close()
    $hashString = [BitConverter]::ToString($hashBytes) -replace '-', ''
    return $hashString.ToLower()
}

$scriptDirectory = if ($PSScriptRoot) { $PSScriptRoot } else { Get-Location }

$patchBase64 = @"
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
"@

$patchFilePath = Join-Path -Path $scriptDirectory -ChildPath "patch_file.xdelta3"
[IO.File]::WriteAllBytes($patchFilePath, [Convert]::FromBase64String($patchBase64))

if (-not (CommandExists "choco")) {
    Write-Host "Chocolatey is not installed. Installing Chocolatey..."
    
    [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
    Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
    
    refreshenv
} else {
    Write-Host "Chocolatey is already installed. Skipping installation."
}

$installedXdelta3 = $false

if (-not (Xdelta3Installed)) {
    Write-Host "xdelta3 is not installed. Installing xdelta3..."
    
    choco install xdelta3 -y
    
    $installedXdelta3 = $true
} else {
    Write-Host "xdelta3 is already installed. Skipping installation."
}

if ($installedXdelta3 -and (CommandExists "xdelta3")) {
    Write-Host "xdelta3 installation verified."
} elseif (-not (CommandExists "xdelta3")) {
    Write-Host "xdelta3 installation failed."
    exit 1
}

$fileUrl = "https://releases.arc.net/windows/ArcInstaller.exe"
$outputPath = Join-Path -Path $scriptDirectory -ChildPath "ArcInstaller.exe"

Write-Host "Downloading file from $fileUrl to $outputPath..."
Invoke-WebRequest -Uri $fileUrl -OutFile $outputPath

$expectedMd5 = "f4681c38e0505e3cf383726c470ab363"
$actualMd5 = Get-FileMD5 -filePath $outputPath

Write-Host "Expected v1.1.0.0 MD5: $expectedMd5"
Write-Host "Found MD5: $actualMd5"

if ($actualMd5 -eq $expectedMd5) {
    Write-Host "MD5 checksum verification passed."
    $patchedOutputPath = Join-Path -Path $scriptDirectory -ChildPath "patched_output.exe"
    $finalOutputPath = Join-Path -Path $scriptDirectory -ChildPath "ArcInstaller-1.0.0.0.exe"
    & xdelta3 -d -s $outputPath $patchFilePath $patchedOutputPath
    Rename-Item -Path $patchedOutputPath -NewName $finalOutputPath

    $finalExpectedMd5 = "19d292132925e6ddd808e273fd0fea85"
    $finalActualMd5 = Get-FileMD5 -filePath $finalOutputPath

    Write-Host "Expected v1.0.0.0 MD5: $finalExpectedMd5"
    Write-Host "Found MD5: $finalActualMd5"

    if ($finalActualMd5 -eq $finalExpectedMd5) {
        Write-Host "MD5 checksum verification passed for ArcInstaller-1.0.0.0.exe."
        Remove-Item $patchFilePath
        Remove-Item $outputPath
    } else {
        Write-Host "MD5 checksum verification failed for ArcInstaller-1.0.0.0.exe. Expected: $finalExpectedMd5, Got: $finalActualMd5"
        exit 1
    }
} else {
    Write-Host "MD5 checksum verification failed. Expected: $expectedMd5, Got: $actualMd5"
    Remove-Item $patchFilePath
    Remove-Item $outputPath
    exit 1
}
