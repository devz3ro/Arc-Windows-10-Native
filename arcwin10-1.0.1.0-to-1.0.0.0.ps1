function CommandExists {
    param(
        [string]$command
    )
    $null -ne (Get-Command $command -ErrorAction SilentlyContinue)
}

function Xdelta3Installed {
    Get-Command xdelta3 -ErrorAction SilentlyContinue
}

function Get-FileMD5 {
    param (
        [string]$filePath
    )
    $md5 = [System.Security.Cryptography.MD5]::Create()
    $fileStream = [System.IO.File]::OpenRead($filePath)
    $hashBytes = $md5.ComputeHash($fileStream)
    $fileStream.Close()
    $hashString = [BitConverter]::ToString($hashBytes) -replace '-', ''
    return $hashString.ToLower()
}

$scriptDirectory = if ($PSScriptRoot) { $PSScriptRoot } else { Get-Location }

$patchBase64 = @"
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
"@

$patchFilePath = Join-Path -Path $scriptDirectory -ChildPath "patch_file.xdelta3"
[IO.File]::WriteAllBytes($patchFilePath, [Convert]::FromBase64String($patchBase64))

if (-not (CommandExists "choco")) {
    Write-Host "Chocolatey is not installed. Installing Chocolatey..."
    
    [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
    Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
    
    refreshenv
} else {
    Write-Host "Chocolatey is already installed. Skipping installation."
}

$installedXdelta3 = $false

if (-not (Xdelta3Installed)) {
    Write-Host "xdelta3 is not installed. Installing xdelta3..."
    
    choco install xdelta3 -y
    
    $installedXdelta3 = $true
} else {
    Write-Host "xdelta3 is already installed. Skipping installation."
}

if ($installedXdelta3 -and (CommandExists "xdelta3")) {
    Write-Host "xdelta3 installation verified."
} elseif (-not (CommandExists "xdelta3")) {
    Write-Host "xdelta3 installation failed."
    exit 1
}

$fileUrl = "https://releases.arc.net/windows/ArcInstaller.exe"
$outputPath = Join-Path -Path $scriptDirectory -ChildPath "ArcInstaller.exe"

Write-Host "Downloading file from $fileUrl to $outputPath..."
Invoke-WebRequest -Uri $fileUrl -OutFile $outputPath

$expectedMd5 = "930d75cd4b6e69fd38ee9f53cb3a8721"
$actualMd5 = Get-FileMD5 -filePath $outputPath

Write-Host "Expected v1.0.1.0 MD5: $expectedMd5"
Write-Host "Found MD5: $actualMd5"

if ($actualMd5 -eq $expectedMd5) {
    Write-Host "MD5 checksum verification passed."
    $patchedOutputPath = Join-Path -Path $scriptDirectory -ChildPath "patched_output.exe"
    $finalOutputPath = Join-Path -Path $scriptDirectory -ChildPath "ArcInstaller-1.0.0.0.exe"
    & xdelta3 -d -s $outputPath $patchFilePath $patchedOutputPath
    Rename-Item -Path $patchedOutputPath -NewName $finalOutputPath

    $finalExpectedMd5 = "19d292132925e6ddd808e273fd0fea85"
    $finalActualMd5 = Get-FileMD5 -filePath $finalOutputPath

    Write-Host "Expected v1.0.0.0 MD5: $finalExpectedMd5"
    Write-Host "Found MD5: $finalActualMd5"

    if ($finalActualMd5 -eq $finalExpectedMd5) {
        Write-Host "MD5 checksum verification passed for ArcInstaller-1.0.0.0.exe."
        Remove-Item $patchFilePath
        Remove-Item $outputPath
    } else {
        Write-Host "MD5 checksum verification failed for ArcInstaller-1.0.0.0.exe. Expected: $finalExpectedMd5, Got: $finalActualMd5"
        exit 1
    }
} else {
    Write-Host "MD5 checksum verification failed. Expected: $expectedMd5, Got: $actualMd5"
    exit 1
}
